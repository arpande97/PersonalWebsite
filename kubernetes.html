<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Massively by HTML5 UP</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper" class="fade-in">

				<!-- Main -->
					<div id="main">

						<!-- Featured Post -->
							<article class="post featured">
								<header class="major">
									<span class="date"></span>
									<h2><a href="#">Set aliases working with EKS.</a></h2>
                                    <a href="#" class="image main"><img src="images/EKS.png" alt="" width="50" height="200"/></a>

									<p>
                                        In this short post, I would like to briefly give some commands that make navigating in EKS/Openshift easier.
										There's not much theory in this post, only some commands using powerful tools like grep, 
										awk, aliases, and
										basic EKS commands (same commands can then be applied to Openshift with minor changes, like replacing 
										'kubectl' with 'oc'.)
                                    </p>
									<p>
										These commands can then be added to '.bashrc', which after the 'source' command would act like aliases.
									</p>
									<p>
										'kubectl exec -it' command can be used to enter inside a container running in the pod by specifying 
										the pod name. If we don't mention the container, Kubernetes will 'exec' into the first container
										defined in the configuration. This could be a Helm deployment. So in the deployment.yaml, the 
										container that is mentioned first in the tag '<b>containers:</b>', will 
										be execed into.
										
									</p>

									<p>
										A helpful alias for this is as follows:
									</p>
									<a href="#" class="image main"><img src="images/exec.png" alt="" width="50" height="70"/></a>
									<p>
										The usage would something be like this: <b>kexec pod_name</b>. In the long winded route, we would 
										first have to run <b>'kubectl get pods | grep pod_name'</b>. Then copy the pod's name and paste
										it in <b>'kexec -it'</b> command. What happens here is that there's no way you remember the
										pod name because it is generated by concatenation of the application name and a unique 
										identifier which is a random string. Using this alias, you just need to know the application 
										name and you are good to go. This saves the hassle of running 'get pods' first and the copy/
										pasting bit.
										The <b>-it</b> flag opens an interactive shell session inside the container. <b>awk</b>
										 is another helpful command line utility used for pattern searching. Here I am using the 
										 <b>'get pods'</b> command internally, and then passing the pod's name which is the first 
										 field (hence the '$1') to the 'awk' script from the shell (by use of <b>'-v'</b> flag). If it 
										 matches the name passed in <b>'kexec pod_name'</b>, we will be able to enter inside the
										 container.
									</p>
									<p>
										In the same way, we use the <b>'kubectl describe ...'</b> command alias to save us the hassle
										of copy pasting.
									</p>
									<a href="#" class="image main"><img src="images/describe.png" alt="" width="50" height="70"/></a>
									<p>
										Just use <b>'kdp my_app'</b> and you can describe the pod's current state, configuration and 
										other metadata.
									</p>
									<p>
										Next one is little tricky. It has to do with <b>'kubectl logs ...'</b>. Here you can't get away 
										with not mentioning the container name. So we need a way to somehow fetch the container name 
										along with the pod name. We'll get the pod name as we've done before. For the container name,
										we need to revisit our 'Deployment.yaml' file. We can find the name in the tag 
										<b>'.spec.containers[*].name'</b>. So this is how we do it:
									</p>
									<a href="#" class="image main"><img src="images/logs.png" alt="" width="50" height="100"/></a>
									<p>
										The usage is <b>klogs my_app</b>. Instead of copy pasting the pod name and then adding
										a container name to <b> kubectl logs</b> command, you have a much quicker way of 
										getting the logs of the container you want.
									</p>

									<p>
										Next one is less to do with aliases. Let's imagine a scenario. You have a situation where
										your <b>kafka</b> pods are crashing due to memory issues and you have 5 kafka pod replicas
										where you want to 'exec' into each and run <b>'df -h'</b> command to check the 
										memory state. This will take you a lot of time and commands, 'exec-ing' into the pod,
										 run 'df -h', exit the pod, and repeat the process. Here's a quicker way by using the
										 power of shell scripting.

									</p>
									<a href="#" class="image main"><img src="images/kafkapod2.png" alt="" width="50" height="100"/></a>
									<p>
										<b>'-w'</b> tag relates to a full word search. So you run 'get pods', search for kafka pods with 
										'grep' and full word search, use 'awk' to get the first field (which is the name of the pod), and 
										then iterate over the five results, run 'df -h' and you'll have memory info printed on the screen.
									</p>

									<p>
										The next one was very helpful to me. Every time I logged into the AWS console, I would get a
										new token which I had to replace in my <b>'~/.aws/credentials'</b> file to log into my namespace on 
										EKS. So the process would be get the token, 'vi' into the credentials file, 
										delete the old token, replace it with the new one, write/quit (':wq'), and
										then go about my business. To save myself the hassle of opening the editor every time and replacing
										the old token with the new one, I came up with this short useful alias.
									</p>
									<a href="#" class="image main"><img src="images/token.png" alt="" width="50" height="100"/></a>

									<p>
										The usage would be <b>'creds token'</b>. Here I'm using the 'sed' tool, to replace the 
										name of the profile in the copied token with my profile name.
									</p>
                                    </header>
								
							</article>


			

					</div>

				

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>